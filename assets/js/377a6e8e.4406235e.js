"use strict";(self.webpackChunkexperimenter_docs=self.webpackChunkexperimenter_docs||[]).push([[2191],{4137:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=p(n),c=r,h=m["".concat(l,".").concat(c)]||m[c]||d[c]||a;return n?i.createElement(h,o(o({ref:t},u),{},{components:n})):i.createElement(h,o({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[m]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<a;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5224:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var i=n(7462),r=(n(7294),n(4137));const a={id:"mobile-first-run-experiments",title:"First Run Experiments",slug:"/mobile-first-run-experiments"},o=void 0,s={unversionedId:"deep-dives/mobile/mobile-first-run-experiments",id:"deep-dives/mobile/mobile-first-run-experiments",title:"First Run Experiments",description:"First Run Experiments are incredibly important to the experimentation ecosystem, but their functionality comes with some key differences from standard experiments. It is highly advised that experiment owners read through this documentation before writing First Run Experiments.",source:"@site/docs/deep-dives/mobile/first-run-experiments.mdx",sourceDirName:"deep-dives/mobile",slug:"/mobile-first-run-experiments",permalink:"/mobile-first-run-experiments",draft:!1,editUrl:"https://github.com/mozilla/experimenter-docs/edit/main/docs/deep-dives/mobile/first-run-experiments.mdx",tags:[],version:"current",frontMatter:{id:"mobile-first-run-experiments",title:"First Run Experiments",slug:"/mobile-first-run-experiments"},sidebar:"sidebar",previous:{title:"Feature API",permalink:"/mobile-feature-api"},next:{title:"Surveys",permalink:"/mobile-surveys"}},l={},p=[{value:"What is a First Run Experiment?",id:"what-is-a-first-run-experiment",level:2},{value:"Application Bundling",id:"application-bundling",level:3},{value:"Enrollment",id:"enrollment",level:3},{value:"Advanced Targeting",id:"advanced-targeting",level:3},{value:"How do I know if an experiment should be first run?",id:"how-do-i-know-if-an-experiment-should-be-first-run",level:2}],u={toc:p},m="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"First Run Experiments are incredibly important to the experimentation ecosystem, but their functionality comes with some key differences from standard experiments. It is ",(0,r.kt)("em",{parentName:"p"},"highly")," advised that experiment owners read through this documentation before writing First Run Experiments."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"While the concept of First Run Experiments is also supported by Firefox for Desktop, this particular documentation only applies to our mobile applications such as Firefox and Focus for Android/iOS.")),(0,r.kt)("h2",{id:"what-is-a-first-run-experiment"},"What is a First Run Experiment?"),(0,r.kt)("p",null,"A First Run Experiment is one that needs to enroll clients on their first launch of the application. All First Run Experiments bundled with a particular app version would be evaluated for enrollment on the very first run of the application after it is installed."),(0,r.kt)("p",null,'An experiment can be marked as a First Run Experiment by checking the "First Run Experiment" checkbox while editing the experiment in the audience page.'),(0,r.kt)("img",{title:"First run checkbox",alt:"The First Run Experiment checkbox is shown on the audience page of an experiment being edited",src:"/img/deep-dives/first-run-experiment-checkbox.png",height:"500",style:{marginBottom:"10px"}}),(0,r.kt)("p",null,"Similarly to sticky enrollment, certain advanced targeting configurations can require an experiment to be first run."),(0,r.kt)("img",{title:"First run checkbox required",alt:"The First Run Experiment checkbox is selected and cannot be edited because the advanced targeting configuration selected requires the experiment to be a First Run Experiment.",src:"/img/deep-dives/first-run-required.png",height:"500",style:{marginBottom:"10px"}}),(0,r.kt)("p",null,"The differences between First Run Experiments and standard experiments show themselves in a few key areas, described below."),(0,r.kt)("h3",{id:"application-bundling"},"Application Bundling"),(0,r.kt)("p",null,"Unlike traditional experiments, First Run Experiments must be bundled with the app. This allows Nimbus to start quickly without needing to make a call to remote settings to fetch the live experiments."),(0,r.kt)("p",null,"This means that any new First Run Experiments are added to the application's source code repository. This happens automatically via the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mozilla-mobile/update-experiments"},(0,r.kt)("inlineCode",{parentName:"a"},"update-experiments")," Github action"),". Below is an example job configuration for this action."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'jobs:\n  update-nimbus-experiments:\n    name: "Update Nimbus Experiments"\n    runs-on: ubuntu-latest\n    steps:\n      - name: "Checkout Main Branch"\n        uses: actions/checkout@v3\n        with:\n          path: $DIRECTORY\n          ref: main\n          fetch-depth: 0\n      - name: "Update Experiments JSON"\n        id: update-experiments-json\n        uses: mozilla-mobile/update-experiments@v3\n        with:\n          repo-path: $DIRECTORY\n          output-path: path/to/initial_experiments.json\n          experimenter-url: https://experimenter.services.mozilla.com/api/v6/experiments-first-run/\n          app-name: $APP_NAME\n          branch: automation/update-nimbus-experiments\n      - name: Create Pull Request\n        id: create-pull-request\n        uses: peter-evans/create-pull-request@v4\n        if: steps.update-experiments-json.outputs.changed == 1 && steps.update-experiments-json.outputs.changed-branch == 1\n        with:\n          token: ${{ secrets.GITHUB_TOKEN }}\n          path: $DIRECTORY\n          branch: automation/update-nimbus-experiments\n          commit-message: "update initial_experiments.json based on the current first-run experiments in experimenter"\n          title: "Update initial experiments JSON for Nimbus"\n          body: "This (automated) PR updates the initial_experiments.json on the `main` branch"\n          delete-branch: true\n')),(0,r.kt)("p",null,"The only file type currently supported is JSON, and this is usually named ",(0,r.kt)("inlineCode",{parentName:"p"},"initial_experiments.json"),". Some examples of how this workflow and file are used can be seen in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mozilla-mobile/firefox-ios/pull/12872/files"},"this PR")," and ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mozilla-mobile/firefox-ios/blob/main/Client/Experiments/initial_experiments.json"},"the ",(0,r.kt)("inlineCode",{parentName:"a"},"initial_experiments.json")," file")," in the Firefox iOS repository."),(0,r.kt)("h3",{id:"enrollment"},"Enrollment"),(0,r.kt)("p",null,"For traditional experiments, enrollment is a short period at the beginning of a live experiment's lifecycle where the experiment can enroll new clients. The Nimbus SDK does not do any date calculations when determining whether an experiment is enrolling clients, instead relying on the ",(0,r.kt)("inlineCode",{parentName:"p"},"isEnrollmentPaused")," experiment field."),(0,r.kt)("p",null,"Because First Run Experiments are bundled with the application, that field will remain ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," in the application bundle for the duration of the release. As a result, ",(0,r.kt)("strong",{parentName:"p"},"even after enrollment is paused remotely via ",(0,r.kt)("a",{parentName:"strong",href:"/workflow/overview"},"Experimenter"),", First Run Experiments on the app's first run will still be evaluated and enrolled.")),(0,r.kt)("p",null,"Even though clients will be enrolling for the duration of the release, only clients enrolled during the enrollment period as defined in Experimenter will be considered for analysis. As a result, it can be worthwhile to set an earlier end date in Experimenter if only to receive your results earlier."),(0,r.kt)("p",null,"When defining the enrollment length and experiment lifetime, it is wise to take this fact into account in planning. As an example, if a First Run Experiment should enroll new clients for one week, its enrollment end date should be one week after the date of release for the version it is targeting."),(0,r.kt)("h3",{id:"advanced-targeting"},"Advanced Targeting"),(0,r.kt)("p",null,"Many use cases for First Run Experiments require advanced targeting configurations. To add a new advanced targeting configuration, a pull request should be opened to the Experimenter repository, adding the configuration to ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mozilla/experimenter/blob/main/app/experimenter/targeting/constants.py"},"this file"),"."),(0,r.kt)("p",null,"Please follow the contributing guidelines when opening PRs to Experimenter. If you require assistance, please reach out in the #ask-experimenter channel on Slack."),(0,r.kt)("h2",{id:"how-do-i-know-if-an-experiment-should-be-first-run"},"How do I know if an experiment should be first run?"),(0,r.kt)("p",null,"In short, if your experiment makes changes to onboarding, needs data from brand-new clients, or otherwise relates to clients who are using Firefox on their device for the first time, then your experiment should most likely be a First Run Experiment."),(0,r.kt)("p",null,"Similarly with advanced targeting above, if you have any questions or would like help in making this determination, please reach out in the #ask-experimenter channel on Slack."))}d.isMDXComponent=!0}}]);